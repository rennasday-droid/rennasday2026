<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Renna‚Äôs Day 2026</title>

  <meta name="description" content="Renna‚Äôs Day 2026 ‚Äî 12 Settembre 2026 ore 18:00. Mappa, video/foto e conferma presenza." />
  <meta name="theme-color" content="#7f00ff" />
  <meta name="color-scheme" content="light" />

  <!-- Canonical + Social preview (SOSTITUISCI L'URL) -->
  <link rel="canonical" href="https://github.com/rennasday-droid/rennasday2026"/>

  <meta property="og:title" content="Renna‚Äôs Day 2026" />
  <meta property="og:description" content="12 Settembre 2026 ‚Ä¢ ore 18:00 ‚Äî Conferma presenza e mappa." />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="it_IT" />
  <meta property="og:url" content="https://TUO-USER.github.io/TUO-REPO/" />

  <!-- Preview immagine (consigliato 1200x630). Metti preview.jpg nel repo -->
  <meta property="og:image" content="https://TUO-USER.github.io/TUO-REPO/preview.jpg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">

  <!-- Structured Data (Event) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Event",
    "name":"Renna‚Äôs Day 2026",
    "description":"Stesse radici, nuovi germogli.",
    "startDate":"2026-09-12T18:00:00+02:00",
    "endDate":"2026-09-12T22:00:00+02:00",
    "eventAttendanceMode":"https://schema.org/OfflineEventAttendanceMode",
    "eventStatus":"https://schema.org/EventScheduled",
    "url":"https://TUO-USER.github.io/TUO-REPO/",
    "location":{
      "@type":"Place",
      "name":"Chiesa S. Michele Arcangelo",
      "address":{
        "@type":"PostalAddress",
        "streetAddress":"Via Varese 5",
        "addressLocality":"Malgesso",
        "addressRegion":"VA",
        "addressCountry":"IT"
      }
    }
  }
  </script>

  <style>
    :root{
      --primary:#00d4ff;
      --primary2:#7f00ff;
      --accent:#ff2d95;
      --accent2:#ffb703;

      --primary-rgb:0 212 255;
      --primary2-rgb:127 0 255;
      --accent-rgb:255 45 149;
      --accent2-rgb:255 183 3;

      --bg1:#fff2ff;
      --bg2:#efffff;

      --text:#070a2a;
      --lead:#1d4ed8;

      --cardA:rgba(255,255,255,.97);
      --cardB:rgba(255,255,255,.88);
      --stroke:rgba(var(--primary2-rgb), .26);

      --shadow: 0 24px 75px rgba(10,0,35,.12);
      --shadowSoft: 0 16px 48px rgba(10,0,35,.10);

      --radius: 34px;
      --ring: 0 0 0 6px rgba(var(--primary-rgb), .22);
      --focus: 0 0 0 4px rgba(var(--accent2-rgb), .30);
    }

    :root{ color-scheme: light; }
    @media (prefers-color-scheme: dark){
      :root{ color-scheme: light; }
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:"Plus Jakarta Sans",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 680px at 18% -10%, rgba(var(--primary-rgb), .32), transparent 55%),
        radial-gradient(980px 560px at 115% 0%, rgba(var(--accent-rgb), .22), transparent 52%),
        radial-gradient(900px 520px at 65% 115%, rgba(var(--accent2-rgb), .20), transparent 56%),
        linear-gradient(135deg,var(--bg1),var(--bg2));
      line-height:1.6;
      overflow-x:hidden;
    }

    .skip-link{
      position:absolute; left:-9999px; top:12px;
      padding:10px 14px;
      border-radius:14px;
      background: linear-gradient(135deg, var(--primary2), var(--accent));
      color:#fff;
      text-decoration:none;
      font-weight:900;
      z-index:999;
    }
    .skip-link:focus{left:12px; outline:none; box-shadow: var(--focus);}

    .bg-orb{
      position:fixed;
      width:480px;height:480px;
      filter: blur(50px);
      opacity:.22;
      z-index:-2;
      border-radius:999px;
      pointer-events:none;
      animation: floaty 10s ease-in-out infinite;
      transform: translate3d(0,0,0);
    }
    .bg-orb.orb1{
      left:-260px; top:220px;
      background: radial-gradient(circle at 30% 30%, rgba(var(--primary2-rgb), .95), rgba(var(--primary2-rgb), 0));
    }
    .bg-orb.orb2{
      width:620px;height:620px;
      right:-300px; top:110px;
      background: radial-gradient(circle at 30% 30%, rgba(var(--accent-rgb), .92), rgba(var(--accent-rgb), 0));
      animation-duration: 12s;
      opacity:.18;
    }
    .bg-orb.orb3{
      width:560px;height:560px;
      left:55%; bottom:-290px;
      background: radial-gradient(circle at 30% 30%, rgba(var(--accent2-rgb), .85), rgba(var(--accent2-rgb), 0));
      animation-duration: 13s;
      opacity:.16;
    }
    @keyframes floaty{0%,100%{transform:translate(0,0) scale(1)}50%{transform:translate(22px,-18px) scale(1.05)}}

    header{
      position:relative;
      padding:114px 18px 84px;
      text-align:center;
      color:#fff;
      background:
        radial-gradient(900px 420px at 22% 18%, rgba(255,255,255,.22), transparent 55%),
        linear-gradient(135deg, var(--primary2), var(--primary), var(--accent), var(--accent2));
      border-bottom-left-radius:58px;
      border-bottom-right-radius:58px;
      box-shadow: 0 18px 54px rgba(var(--primary2-rgb), .24);
      overflow:hidden;
    }
    header:after{
      content:"";
      position:absolute;
      left:-20%; right:-20%;
      bottom:-34px;
      height:104px;
      background: rgba(255,255,255,.16);
      border-top-left-radius:999px;
      border-top-right-radius:999px;
      transform: rotate(-2.2deg);
    }
    header h1{
      margin:0;
      font-size: clamp(2.35rem, 4vw + 1rem, 3.85rem);
      letter-spacing:-1.8px;
      line-height:1.05;
      text-shadow: 0 16px 40px rgba(0,0,0,.18);
      position:relative;
    }
    header p{
      margin:12px 0 0;
      font-size:1.10rem;
      opacity:.98;
      position:relative;
    }

    main{
      max-width: 780px;
      margin:-64px auto 0;
      padding: 0 18px 36px;
    }

    .card{
      background: linear-gradient(135deg, var(--cardA), var(--cardB));
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      padding: 34px;
      box-shadow: var(--shadow);
      margin: 0 0 26px;
      position:relative;
      overflow:hidden;

      transform: translateY(18px);
      opacity: 0;
      will-change: transform, opacity;

      content-visibility:auto;
      contain-intrinsic-size: 1px 520px;
    }
    .card:before{
      content:"";
      position:absolute;
      inset:-2px -2px auto -2px;
      height: 140px;
      background:
        radial-gradient(320px 140px at 10% 40%, rgba(var(--primary-rgb), .18), transparent 60%),
        radial-gradient(320px 140px at 70% 20%, rgba(var(--accent-rgb), .14), transparent 60%),
        radial-gradient(280px 120px at 95% 20%, rgba(var(--accent2-rgb), .16), transparent 60%);
      pointer-events:none;
    }
    .card.reveal{ animation: in .75s ease-out forwards; }
    @keyframes in{to{transform:translateY(0);opacity:1}}

    .card h2{
      margin: 0 0 12px;
      font-size: 1.62rem;
      color: var(--primary2);
      letter-spacing:-.6px;
      position:relative;
    }
    .lead{
      margin:0;
      color: var(--lead);
      font-size:1.03rem;
      font-weight:800;
      position:relative;
    }

    .chip{
      display:inline-flex;
      gap:10px;
      align-items:center;
      padding:10px 14px;
      border-radius:999px;
      background: linear-gradient(135deg, rgba(var(--primary-rgb), .18), rgba(var(--accent-rgb), .14), rgba(var(--accent2-rgb), .14));
      color: #08103a;
      border: 1px solid rgba(var(--primary2-rgb), .18);
      font-weight: 900;
      font-size: .96rem;
      margin-top: 14px;
      position:relative;
    }
    .spark{
      width:10px;height:10px;border-radius:999px;
      background: var(--accent);
      box-shadow: 0 0 0 7px rgba(var(--accent-rgb), .18);
    }

    .countdown{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-top:16px;position:relative}
    .time{
      position:relative;
      background: linear-gradient(135deg, rgba(255,255,255,.98), rgba(255,255,255,.88));
      border-radius: 22px;
      padding: 18px 8px;
      text-align:center;
      border: 1px solid rgba(var(--primary2-rgb), .18);
      box-shadow: var(--shadowSoft);
      overflow:hidden;
    }
    .time .num{
      margin:0;
      font-size:1.98rem;
      color: var(--primary2);
      font-weight:900;
      line-height:1;
      display:block;
      letter-spacing:-.7px;
      position:relative;
      text-shadow: 0 10px 26px rgba(var(--primary2-rgb), .12);
    }
    .time span{
      font-size:.72rem;
      text-transform:uppercase;
      letter-spacing:1px;
      margin-top:6px;
      display:block;
      position:relative;
      color: #1f2aef;
      font-weight:900;
    }

    img.media{
      width:100%;
      border-radius: 26px;
      box-shadow: 0 18px 44px rgba(10,0,35,.14);
      border: 1px solid rgba(255,255,255,.70);
      display:block;
      object-fit:cover;
      max-height:420px;
      background:#fff;
      position:relative;
    }

    .video-stack{display:flex;flex-direction:column;gap:16px;margin-top:16px;position:relative}
    video{
      width:100%;
      display:block;
      border-radius:26px;
      box-shadow:0 18px 44px rgba(10,0,35,.14);
      border: 1px solid rgba(255,255,255,.45);
      background:#000;
      outline:none;
    }
    video:focus{box-shadow: var(--focus);}

    .grid-gallery{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:16px;position:relative}
    .grid-gallery img{
      width:100%;
      aspect-ratio:1/1;
      object-fit:cover;
      border-radius:22px;
      box-shadow:0 16px 34px rgba(10,0,35,.14);
      border:1px solid rgba(255,255,255,.75);
      transition:transform .25s ease, box-shadow .25s ease, filter .25s ease;
      cursor:zoom-in;
    }
    .grid-gallery img:hover{
      transform:translateY(-2px) scale(1.01);
      box-shadow:0 22px 46px rgba(10,0,35,.18);
      filter:saturate(1.10) contrast(1.03);
    }
    .grid-gallery img:focus{outline:none;box-shadow: var(--focus);}

    .where-grid{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap: 14px;
      margin-top: 16px;
      position:relative;
    }
    .where-box{
      background: linear-gradient(135deg, rgba(255,255,255,.98), rgba(255,255,255,.88));
      border: 1px solid rgba(var(--accent-rgb), .18);
      border-radius: 24px;
      padding: 18px;
      box-shadow: var(--shadowSoft);
      position:relative;
      overflow:hidden;
    }
    .kv{margin-top: 10px;display:grid;gap: 8px;position:relative}
    .kv .rowkv{
      display:flex;
      gap: 10px;
      justify-content: space-between;
      align-items: center;
      padding: 10px 12px;
      border-radius: 16px;
      background: linear-gradient(135deg, rgba(var(--primary-rgb), .12), rgba(var(--accent-rgb), .10), rgba(var(--accent2-rgb), .10));
      border: 1px solid rgba(var(--primary2-rgb), .16);
      font-weight: 900;
      color: #050a2a;
    }
    .kv .rowkv span{color: var(--primary2);font-weight:900}

    .map{
      border-radius: 24px;
      overflow:hidden;
      border: 1px solid rgba(var(--primary2-rgb), .18);
      box-shadow: 0 18px 44px rgba(10,0,35,.14);
      background:#fff;
      min-height: 250px;
    }
    .map iframe{width:100%;height:100%;border:0;display:block}

    form{margin-top:16px;position:relative}
    label{
      display:block;
      font-weight:900;
      margin-bottom:8px;
      font-size:.95rem;
      color: var(--primary2);
    }
    input,select,textarea{
      width:100%;
      padding:16px;
      margin-bottom:14px;
      border-radius:18px;
      border:2px solid rgba(var(--primary2-rgb), .18);
      background: linear-gradient(135deg, rgba(255,255,255,.98), rgba(255,255,255,.90));
      font-family:inherit;
      font-size:1rem;
      transition:.22s ease;
      outline:none;
      color: #050a2a;
      box-shadow: 0 10px 24px rgba(2,6,23,.08);
    }
    input:focus,select:focus,textarea:focus{
      border-color: rgba(var(--primary-rgb), 1);
      background:#fff;
      box-shadow: var(--ring);
    }

    .row{display:flex;gap: 12px;flex-wrap: wrap;}
    .row > div{flex:1;min-width: 150px}

    .pillbox{display:flex;flex-wrap: wrap;gap: 10px;margin: 6px 0 14px;}
    .pill{
      display:flex;
      align-items:center;
      gap: 10px;
      padding: 12px 14px;
      border-radius: 999px;
      background: linear-gradient(135deg, rgba(var(--primary2-rgb), .10), rgba(var(--primary-rgb), .10), rgba(var(--accent2-rgb), .10));
      border: 1px solid rgba(var(--accent-rgb), .16);
      font-weight: 900;
      color: #050a2a;
      cursor:pointer;
      user-select:none;
    }
    .pill input{accent-color: var(--accent); margin:0}

    .mamma-note{
      background: linear-gradient(135deg, rgba(var(--accent2-rgb), .22), rgba(var(--accent-rgb), .16), rgba(var(--primary-rgb), .14));
      border: 1px solid rgba(var(--accent-rgb), .20);
      border-left: 6px solid var(--accent);
      padding: 18px 18px;
      border-radius: 18px;
      margin: 6px 0 14px;
      color: #3a0a2a;
      font-size: .97rem;
      font-weight: 900;
    }

    .btn{
      display:inline-flex;
      width:100%;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding:18px;
      border-radius:26px;
      font-weight:900;
      letter-spacing:.2px;
      text-decoration:none;
      border:none;
      font-size:1.06rem;
      cursor:pointer;
      transition: transform .18s ease, box-shadow .18s ease, filter .18s ease;
      user-select:none;
      position:relative;
      overflow:hidden;
      color:#fff;
    }
    .btn:focus{outline:none; box-shadow: var(--focus);}

    .btn-primary{
      background: linear-gradient(135deg, var(--primary2), var(--accent), var(--accent2));
      box-shadow: 0 18px 54px rgba(var(--accent-rgb), .18);
    }
    .btn-secondary{
      margin-top: 12px;
      background: linear-gradient(135deg, var(--primary), var(--primary2));
      box-shadow: 0 16px 46px rgba(var(--primary2-rgb), .18);
    }
    .btn[disabled]{ opacity:.85; cursor:not-allowed; transform:none !important; }

    /* Toast (icona grande sempre leggibile) */
    .toast{
  position: fixed;
  left: 50%;
  bottom: max(18px, env(safe-area-inset-bottom));
  transform: translateX(-50%) translateY(30px);

  background: linear-gradient(135deg,
    rgba(5,10,42,.94),
    rgba(127,0,255,.78),
    rgba(255,45,149,.68)
  );
  color:#fff;

  padding: 14px 16px;
  border-radius: 16px;
  font-weight: 900;
  font-size: 1.02rem;

  opacity: 0;
  pointer-events: none;
  transition: .25s ease;
  z-index: 9999;

  box-shadow: 0 18px 44px rgba(0,0,0,.26);
  border: 1px solid rgba(255,255,255,.22);
  text-shadow: 0 2px 10px rgba(0,0,0,.35);

  display:flex;
  align-items:center;
  gap:10px;
}

.toast.show{
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}

.toast-ico{
  width:32px; height:32px;
  border-radius:14px;
  display:grid; place-items:center;
  background: rgba(255,255,255,.18);
  border: 1px solid rgba(255,255,255,.22);
  box-shadow: 0 10px 22px rgba(0,0,0,.18);
  font-size: 19px;
  line-height: 1;
  flex: 0 0 auto;
}

.toast-txt{ display:block; }


    /* Lightbox */
    .lightbox{
      position:fixed; inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background: rgba(2,6,23,.74);
      z-index: 60;
      padding: 18px;
    }
    .lightbox.open{display:flex}
    .lightbox-inner{
      position:relative;
      width: min(920px, 96vw);
      max-height: 86vh;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .lightbox img{
      max-width: 100%;
      max-height: 86vh;
      border-radius: 18px;
      box-shadow: 0 22px 60px rgba(0,0,0,.35);
      border: 1px solid rgba(255,255,255,.35);
      background:#fff;
    }
    .lb-close{
      position:absolute;
      top:-10px; right:-10px;
      width:44px; height:44px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.35);
      background: linear-gradient(135deg, rgba(var(--primary2-rgb), .80), rgba(var(--accent-rgb), .70));
      color:#fff;
      font-weight:900;
      cursor:pointer;
      display:grid;
      place-items:center;
    }
    .lb-close:focus{outline:none; box-shadow: var(--focus);}

    footer{
      padding:30px 18px 46px;
      text-align:center;
      color: var(--primary2);
      font-weight:900;
      font-size:.98rem;
      text-shadow: 0 10px 30px rgba(var(--primary2-rgb), .10);
    }

    @media (prefers-reduced-motion: reduce){
      html{scroll-behavior:auto}
      *{animation:none !important;transition:none !important}
      .bg-orb{display:none}
      .card{opacity:1; transform:none}
    }
    @media (max-width: 720px){
      .where-grid{grid-template-columns: 1fr;}
      .map{min-height: 280px}
    }
    @media (max-width: 520px){
      .card{padding: 26px}
      .countdown{gap:10px}
      .time{padding:16px 6px}
      .grid-gallery{gap:12px}
    }
  </style>
</head>

<body>
  <a class="skip-link" href="#contenuto">Vai al contenuto</a>

  <div class="bg-orb orb1"></div>
  <div class="bg-orb orb2"></div>
  <div class="bg-orb orb3"></div>

  <header>
    <h1>Renna‚Äôs Day 2026</h1>
    <p>üçÉ Stesse radici, nuovi germogli üçÉ</p>
  </header>

  <main id="contenuto">

    <section class="card" aria-label="Countdown">
      <h2>üìÖ Il grande giorno</h2>
      <p class="lead">Mancano ancora pochi mesi al <strong>12 Settembre 2026</strong>. Non vediamo l‚Äôora!</p>
      <div class="chip"><span class="spark"></span> Sab 12/09/2026 ‚Ä¢ ore <span id="eventTimeLabel">18:00</span></div>

      <div class="countdown" role="group" aria-label="Conto alla rovescia">
        <div class="time"><span class="num" id="days">0</span><span>Giorni</span></div>
        <div class="time"><span class="num" id="hours">00</span><span>Ore</span></div>
        <div class="time"><span class="num" id="minutes">00</span><span>Min</span></div>
        <div class="time"><span class="num" id="seconds">00</span><span>Sec</span></div>
      </div>
    </section>

    <section class="card" aria-label="Origini">
      <h2>‚ù§Ô∏è Le nostre origini</h2>
      <p class="lead">Tutto √® iniziato da loro. Oggi ci ritroviamo per condividere un momento speciale insieme.</p>
      <img class="media" src="nonni.jpg" alt="I nonni Renna" loading="lazy" decoding="async">
    </section>

    <section class="card" aria-label="Dove">
      <h2>üìç Dove ci vediamo</h2>
      <p class="lead">Ci incontriamo alla <strong>Chiesa S. Michele Arcangelo</strong>, a Malgesso. Tutto a portata di click.</p>

      <div class="where-grid">
        <div class="where-box">
          <div class="kv">
            <div class="rowkv">
              <span>üïí Orario</span>
              <div><strong id="placeTime">18:00</strong></div>
            </div>
            <div class="rowkv">
              <span>üöó Parcheggio</span>
              <div><strong id="placeParking">Nei pressi</strong></div>
            </div>
          </div>

          <a class="btn btn-primary" target="_blank" rel="noopener"
             href="https://www.google.it/maps/place/Chiesa+S.+Michele+Arcangelo/@45.8285539,8.670413,17z/data=!3m1!4b1!4m6!3m5!1s0x478679b93ebc2acf:0x71ee08c54737306e!8m2!3d45.8285502!4d8.6729879!16s%2Fg%2F1tp8yxvs?entry=ttu&amp;g_ep=EgoyMDI2MDIxMC4wIKXMDSoASAFQAw%3D%3D">
            üß≠ Apri su Google Maps
          </a>

          <a class="btn btn-secondary" target="_blank" rel="noopener"
             href="https://waze.com/ul?q=Chiesa%20S.%20Michele%20Arcangelo%2C%20Via%20Varese%205%2C%20Malgesso&amp;navigate=yes">
            üöò Apri su Waze
          </a>
        </div>

        <div class="map" aria-label="Mappa">
          <iframe
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
            src="https://www.google.com/maps?q=Chiesa%20S.%20Michele%20Arcangelo%2C%20Via%20Varese%205%2C%20Malgesso&amp;output=embed">
          </iframe>
        </div>
      </div>

      <div class="mamma-note" style="margin-top:14px">
        <strong>üí° Tip:</strong> se arrivi da lontano o hai esigenze particolari, scrivilo nelle note: organizziamo tutto al meglio.
      </div>
    </section>

    <section class="card" aria-label="Video 2025">
      <h2>üé• Rivivi il 2025</h2>
      <p class="lead">I sorrisi e i momenti pi√π belli dell‚Äôanno scorso. Con anteprime ‚Äúda cinema‚Äù.</p>

      <div class="video-stack">
        <video controls preload="metadata" playsinline poster="poster1.jpg"><source src="video1.mp4" type="video/mp4"></video>
        <video controls preload="metadata" playsinline poster="poster2.jpg"><source src="video2.mp4" type="video/mp4"></video>
        <video controls preload="metadata" playsinline poster="poster3.jpg"><source src="video3.mp4" type="video/mp4"></video>
        <video controls preload="metadata" playsinline poster="poster4.jpg"><source src="video4.mp4" type="video/mp4"></video>
      </div>
    </section>

    <section class="card" aria-label="Foto 2025">
      <h2>üì∏ Album Fotografico 2025</h2>
      <p class="lead">Clicca una foto per ingrandire.</p>

      <div class="grid-gallery" id="gallery">
        <img src="2025-1.jpg" alt="Renna‚Äôs Day 2025 - Foto 1" loading="lazy" decoding="async" tabindex="0">
        <img src="2025-2.jpg" alt="Renna‚Äôs Day 2025 - Foto 2" loading="lazy" decoding="async" tabindex="0">
        <img src="2025-3.jpg" alt="Renna‚Äôs Day 2025 - Foto 3" loading="lazy" decoding="async" tabindex="0">
        <img src="2025-4.jpg" alt="Renna‚Äôs Day 2025 - Foto 4" loading="lazy" decoding="async" tabindex="0">
      </div>

      <a href="https://drive.google.com/drive/folders/1b0lHD7dtFqek15hT5TNBXe5YW8YSz4u2"
         target="_blank" rel="noopener" class="btn btn-secondary">
        Guarda tutte le foto su Drive
      </a>
    </section>

    <section class="card" aria-label="RSVP">
      <h2>‚úÖ Conferma la tua presenza</h2>
      <p class="lead">Due minuti e ci aiuti tantissimo. Grazie! ‚ù§Ô∏è</p>

      <noscript>
        <div class="mamma-note"><strong>‚ö†Ô∏è</strong> Per inviare la conferma serve JavaScript attivo.</div>
      </noscript>

      <form id="rsvpForm"
            action="https://script.google.com/macros/s/AKfycbwyu4HVZ7ZEeW2xe4flqf_zrYzefVHUgTDf_v3bNAhS_RUQ9x7z5wNRfNhwQQ7LnWbPnA/exec"
            method="POST"
            target="hidden_iframe">

        <div style="position:absolute; left:-9999px; width:1px; height:1px; overflow:hidden;" aria-hidden="true">
          <label>Se vedi questo campo, lascialo vuoto</label>
          <input type="text" name="website" tabindex="-1" autocomplete="off">
        </div>

        <label for="famiglia">Nome e Cognome della famiglia</label>
        <input id="famiglia" type="text" name="Famiglia" placeholder="es. Famiglia Rossi" required autocomplete="name">

        <div class="row">
          <div>
            <label for="partecipazione">Parteciperete?</label>
            <select name="Partecipazione" id="partecipazione" required>
              <option value="SI">S√¨, saremo presenti! üéâ</option>
              <option value="NO">No, purtroppo non riusciamo üòî</option>
            </select>
          </div>

          <div>
            <label for="telefono">üìû Telefono (opzionale)</label>
            <input id="telefono" type="tel" name="Telefono" placeholder="es. 333 123 4567" inputmode="tel" autocomplete="tel">
          </div>
        </div>

        <div class="row">
          <div>
            <label for="adulti">N¬∞ Adulti</label>
            <input type="number" name="Adulti" id="adulti" value="2" min="0" inputmode="numeric">
          </div>
          <div>
            <label for="bambini">N¬∞ Bambini</label>
            <input type="number" name="Bambini" id="bambini" value="0" min="0" inputmode="numeric">
          </div>
        </div>

        <label>‚ú® Ci dai una mano con qualcosa?</label>
        <div class="pillbox">
          <label class="pill"><input type="checkbox" name="Contributi[]" value="Dolce fatto in casa"> üç∞ <span>Porto un dolce</span></label>
          <label class="pill"><input type="checkbox" name="Contributi[]" value="Vino/Bevande"> ü•Ç <span>Porto bevande</span></label>
          <label class="pill"><input type="checkbox" name="Contributi[]" value="Aiuto organizzazione"> ü§ù <span>Do una mano</span></label>
        </div>

        <label for="note">Allergie, intolleranze o note</label>
        <textarea id="note" name="Note" rows="3"></textarea>

        <input type="hidden" name="Evento" value="Renna's Day 2026 - 12/09/2026">
        <input type="hidden" name="Location" value="Chiesa S. Michele Arcangelo - Via Varese 5, Malgesso (VA)">

        <button type="submit" class="btn btn-primary" id="submitBtn">Invia Conferma ‚úÖ</button>
        <button type="button" class="btn btn-secondary" id="addToCalendarBtn">üìÖ Aggiungi al calendario</button>
        <a href="#" class="btn btn-secondary" id="googleCalBtn" target="_blank" rel="noopener">‚ûï Aggiungi su Google Calendar</a>
      </form>
    </section>

    <footer>Renna‚Äôs Day 2026 ‚ù§Ô∏è Una famiglia, un cuore solo.</footer>
  </main>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="lightbox-inner">
      <button type="button" class="lb-close" aria-label="Chiudi (Esc)">‚úï</button>
      <img id="lightboxImg" alt="Foto ingrandita">
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast" role="status" aria-live="polite" aria-atomic="true">
  <span class="toast-ico" id="toastIco" aria-hidden="true">‚úÖ</span>
  <span class="toast-txt" id="toastTxt">Fatto</span>
</div>

  <!-- IFRAME nascosto per Apps Script -->
  <iframe id="hidden_iframe" name="hidden_iframe" style="display:none;"></iframe>

  <script>
    "use strict";

    const $ = (id) => document.getElementById(id);
    function pad2(n){ return String(n).padStart(2, "0"); }
    function icsEscape(str){
      return String(str)
        .replace(/\\/g, "\\\\")
        .replace(/\n/g, "\\n")
        .replace(/;/g, "\\;")
        .replace(/,/g, "\\,");
    }

    /* Reveal cards */
    (function revealCards(){
      const cards = Array.from(document.querySelectorAll(".card"));
      if (!("IntersectionObserver" in window)){
        cards.forEach(c => c.classList.add("reveal"));
        return;
      }
      const io = new IntersectionObserver((entries) => {
        entries.forEach((e) => {
          if (e.isIntersecting){
            e.target.classList.add("reveal");
            io.unobserve(e.target);
          }
        });
      }, { threshold: 0.12 });
      cards.forEach(c => io.observe(c));
    })();

    /* Countdown (ROBUSTO SU TUTTI I FUSI ORARI) */
    const EVENT_ISO = "2026-09-12T18:00:00+02:00";
    const EVENT = new Date(EVENT_ISO);
    const eventDate = EVENT.getTime();

    const timeIT = new Intl.DateTimeFormat("it-IT", {
      timeZone: "Europe/Rome",
      hour: "2-digit",
      minute: "2-digit"
    }).format(EVENT);

    $("eventTimeLabel").textContent = timeIT;
    $("placeTime").textContent = timeIT;

    const $days = $("days");
    const $hours = $("hours");
    const $minutes = $("minutes");
    const $seconds = $("seconds");

    function updateCountdown(){
      const distance = eventDate - Date.now();
      if (distance <= 0){
        $days.textContent = "0";
        $hours.textContent = "00";
        $minutes.textContent = "00";
        $seconds.textContent = "00";
        return false;
      }

      const days = Math.floor(distance / (1000*60*60*24));
      let rest = distance % (1000*60*60*24);
      const hours = Math.floor(rest / (1000*60*60));
      rest %= (1000*60*60);
      const minutes = Math.floor(rest / (1000*60));
      const seconds = Math.floor((rest % (1000*60)) / 1000);

      $days.textContent = days;
      $hours.textContent = pad2(hours);
      $minutes.textContent = pad2(minutes);
      $seconds.textContent = pad2(seconds);
      return true;
    }

    updateCountdown();
    let countdownTimer = setInterval(() => {
      if (!updateCountdown()) clearInterval(countdownTimer);
    }, 1000);

    /* Gallery Lightbox + focus */
    const gallery = $("gallery");
    const lightbox = $("lightbox");
    const lightboxImg = $("lightboxImg");
    const closeBtn = lightbox.querySelector(".lb-close");
    let lastFocus = null;
    let prevBodyOverflow = "";

    function openLightbox(src, alt){
      lastFocus = document.activeElement;
      prevBodyOverflow = document.body.style.overflow || "";
      document.body.style.overflow = "hidden";

      lightboxImg.src = src;
      lightboxImg.alt = alt || "Foto ingrandita";
      lightbox.classList.add("open");
      lightbox.setAttribute("aria-hidden", "false");
      closeBtn.focus();
    }
    function closeLightbox(){
      lightbox.classList.remove("open");
      lightbox.setAttribute("aria-hidden", "true");
      lightboxImg.src = "";
      document.body.style.overflow = prevBodyOverflow;

      if (lastFocus && typeof lastFocus.focus === "function") lastFocus.focus();
    }

    gallery.addEventListener("click", (e) => {
      const img = e.target.closest("img");
      if (!img) return;
      openLightbox(img.src, img.alt);
    });
    gallery.addEventListener("keydown", (e) => {
      const img = e.target.closest("img");
      if (!img) return;
      if (e.key === "Enter" || e.key === " "){
        e.preventDefault();
        openLightbox(img.src, img.alt);
      }
    });

    lightbox.addEventListener("click", (e) => { if (e.target === lightbox) closeLightbox(); });
    closeBtn.addEventListener("click", closeLightbox);
    document.addEventListener("keydown", (e) => { if (e.key === "Escape") closeLightbox(); });

    function trapFocus(e){
      if (!lightbox.classList.contains("open")) return;
      if (e.key !== "Tab") return;
      const focusables = [closeBtn];
      const first = focusables[0];
      const last = focusables[focusables.length - 1];
      if (e.shiftKey && document.activeElement === first){
        e.preventDefault(); last.focus();
      } else if (!e.shiftKey && document.activeElement === last){
        e.preventDefault(); first.focus();
      }
    }
    document.addEventListener("keydown", trapFocus);

    /* Toast (icona grande) */
    const toast = $("toast");
    const toastIco = $("toastIco");
    const toastTxt = $("toastTxt");
    let toastTimer = null;

    function showToast(msg, kind = "success"){
      toastTxt.textContent = msg;
      toastIco.textContent =
        kind === "loading" ? "‚è≥" :
        kind === "success" ? "‚úÖ" :
        "‚ÑπÔ∏è";

      toast.classList.add("show");
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => toast.classList.remove("show"), 2600);
    }

    /* RSVP UX + submit via hidden iframe */
    const partecipazione = $("partecipazione");
    const adulti = $("adulti");
    const bambini = $("bambini");
    const form = $("rsvpForm");
    const submitBtn = $("submitBtn");
    const submitBtnOriginal = submitBtn.textContent;

    function syncCounts(){
      const isNo = partecipazione.value === "NO";
      adulti.readOnly = isNo;
      bambini.readOnly = isNo;

      adulti.style.opacity = isNo ? "0.85" : "1";
      bambini.style.opacity = isNo ? "0.85" : "1";

      if (isNo){
        adulti.value = 0;
        bambini.value = 0;
      } else {
        if (Number(adulti.value) === 0) adulti.value = 2;
      }
    }
    partecipazione.addEventListener("change", syncCounts);
    syncCounts();

    const iframe = $("hidden_iframe");
    let pendingSubmit = false;

    iframe.addEventListener("load", () => {
      if (!pendingSubmit) return;
      pendingSubmit = false;

      showToast("Conferma inviata!", "success");
      form.reset();
      syncCounts();

      submitBtn.textContent = submitBtnOriginal;
      submitBtn.disabled = false;
      submitBtn.removeAttribute("aria-busy");
    });

    form.addEventListener("submit", (e) => {
      e.preventDefault();

      const hp = form.querySelector('input[name="website"]');
      if (hp && hp.value.trim() !== ""){
        showToast("Ok", "info");
        return;
      }

      submitBtn.disabled = true;
      submitBtn.setAttribute("aria-busy", "true");
      submitBtn.textContent = "Invio‚Ä¶ ‚è≥";
      showToast("Invio in corso‚Ä¶", "loading");

      pendingSubmit = true;
      form.submit();

      setTimeout(() => {
        if (pendingSubmit) {
          pendingSubmit = false;
          showToast("Inviato (controllo in corso)", "success");
          submitBtn.textContent = submitBtnOriginal;
          submitBtn.disabled = false;
          submitBtn.removeAttribute("aria-busy");
        }
      }, 4500);
    });

    /* Add to Calendar (ICS) */
    const addBtn = $("addToCalendarBtn");
    const googleCalBtn = $("googleCalBtn");

    function toICSDate(d){
      const yyyy = d.getUTCFullYear();
      const mm = String(d.getUTCMonth()+1).padStart(2,"0");
      const dd = String(d.getUTCDate()).padStart(2,"0");
      const hh = String(d.getUTCHours()).padStart(2,"0");
      const mi = String(d.getUTCMinutes()).padStart(2,"0");
      const ss = String(d.getUTCSeconds()).padStart(2,"0");
      return `${yyyy}${mm}${dd}T${hh}${mi}${ss}Z`;
    }

    addBtn.addEventListener("click", () => {
      const start = new Date(eventDate);
      const end = new Date(eventDate + 4*60*60*1000);
      const locationText = "Chiesa S. Michele Arcangelo - Via Varese 5, Malgesso (VA)";

      const ics =
`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Renna's Day//IT
CALSCALE:GREGORIAN
METHOD:PUBLISH
BEGIN:VEVENT
UID:${Date.now()}@rennasday
DTSTAMP:${toICSDate(new Date())}
DTSTART:${toICSDate(start)}
DTEND:${toICSDate(end)}
SUMMARY:${icsEscape("Renna's Day 2026")}
DESCRIPTION:${icsEscape("Stesse radici, nuovi germogli.")}
LOCATION:${icsEscape(locationText)}
END:VEVENT
END:VCALENDAR`;

      const blob = new Blob([ics], { type: "text/calendar;charset=utf-8" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "Renna-s-Day-2026.ics";
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);

      showToast("Aggiunto al calendario", "success");
    });

    /* Google Calendar link */
    (function setupGoogleCalendarLink(){
      const startUTC = toICSDate(new Date(eventDate));
      const endUTC = toICSDate(new Date(eventDate + 4*60*60*1000));
      const text = encodeURIComponent("Renna's Day 2026");
      const details = encodeURIComponent("Stesse radici, nuovi germogli.");
      const location = encodeURIComponent("Chiesa S. Michele Arcangelo - Via Varese 5, Malgesso (VA)");
      const dates = `${startUTC}/${endUTC}`;
      googleCalBtn.href = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${text}&details=${details}&location=${location}&dates=${dates}`;
    })();
  </script>
</body>
</html>
"v2"
